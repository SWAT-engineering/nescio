module IP_anonymzation

import TCP_IP from bird

str ENCRYPTION_CONSTANT = "30313233343536373839414243444546" 

rule HideIPsrc:
	IPPacket.head.srcAddress => encryptIP(ENCRYPTION_CONSTANT, 16)

rule HideIPDst:
	IPPacket.head.dstAddress => encryptIP(ENCRYPTION_CONSTANT, 16)

@(nl.cwi.anon.FFXIPAddress)	
algorithm ffx_IPaddress(str key, int mask)


